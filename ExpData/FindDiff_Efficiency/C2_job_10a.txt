+---------------------------------------------------------+------------+-----------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                                      | estRows    | task      | access object                                      | operator info                                                                                                                                                                                                                |
+---------------------------------------------------------+------------+-----------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| HashAgg_31                                              | 1.00       | root      |                                                    | funcs:min(test.char_name.name)->Column#43, funcs:min(test.title.title)->Column#44                                                                                                                                            |
| └─Projection_33                                         | 236.56     | root      |                                                    | test.char_name.name, test.title.title                                                                                                                                                                                        |
|   └─IndexJoin_39                                        | 236.56     | root      |                                                    | inner join, inner:TableReader_36, outer key:test.cast_info.person_role_id, inner key:test.char_name.id, equal cond:eq(test.cast_info.person_role_id, test.char_name.id)                                                      |
|     ├─HashJoin_116(Build)                               | 235.00     | root      |                                                    | inner join, equal:[eq(test.movie_companies.company_type_id, test.company_type.id)]                                                                                                                                           |
|     │ ├─TableReader_244(Build)                          | 4.00       | root      |                                                    | data:TableFullScan_243                                                                                                                                                                                                       |
|     │ │ └─TableFullScan_243                             | 4.00       | cop[tikv] | table:ct                                           | keep order:false                                                                                                                                                                                                             |
|     │ └─IndexJoin_136(Probe)                            | 235.00     | root      |                                                    | inner join, inner:TableReader_132, outer key:test.movie_companies.company_id, inner key:test.company_name.id, equal cond:eq(test.movie_companies.company_id, test.company_name.id)                                           |
|     │   ├─IndexHashJoin_148(Build)                      | 94603.55   | root      |                                                    | inner join, inner:IndexLookUp_145, outer key:test.title.id, inner key:test.movie_companies.movie_id, equal cond:eq(test.cast_info.movie_id, test.movie_companies.movie_id), eq(test.title.id, test.movie_companies.movie_id) |
|     │   │ ├─IndexJoin_163(Build)                        | 39556.18   | root      |                                                    | inner join, inner:TableReader_159, outer key:test.cast_info.movie_id, inner key:test.title.id, equal cond:eq(test.cast_info.movie_id, test.title.id)                                                                         |
|     │   │ │ ├─IndexHashJoin_196(Build)                  | 39539.28   | root      |                                                    | inner join, inner:IndexLookUp_193, outer key:test.role_type.id, inner key:test.cast_info.role_id, equal cond:eq(test.role_type.id, test.cast_info.role_id)                                                                   |
|     │   │ │ │ ├─TableReader_227(Build)                  | 0.01       | root      |                                                    | data:Selection_226                                                                                                                                                                                                           |
|     │   │ │ │ │ └─Selection_226                         | 0.01       | cop[tikv] |                                                    | eq(test.role_type.role, "actor")                                                                                                                                                                                             |
|     │   │ │ │ │   └─TableFullScan_225                   | 12.00      | cop[tikv] | table:rt                                           | keep order:false                                                                                                                                                                                                             |
|     │   │ │ │ └─IndexLookUp_193(Probe)                  | 3294940.36 | root      |                                                    |                                                                                                                                                                                                                              |
|     │   │ │ │   ├─IndexRangeScan_190(Build)             | 4118675.45 | cop[tikv] | table:ci, index:role_id_cast_info(role_id)         | range: decided by [eq(test.cast_info.role_id, test.role_type.id)], keep order:false                                                                                                                                          |
|     │   │ │ │   └─Selection_192(Probe)                  | 3294940.36 | cop[tikv] |                                                    | like(test.cast_info.note, "%(uncredited)%", 92), like(test.cast_info.note, "%(voice)%", 92), not(isnull(test.cast_info.person_role_id))                                                                                      |
|     │   │ │ │     └─TableRowIDScan_191                  | 4118675.45 | cop[tikv] | table:ci                                           | keep order:false                                                                                                                                                                                                             |
|     │   │ │ └─TableReader_159(Probe)                    | 0.33       | root      |                                                    | data:Selection_158                                                                                                                                                                                                           |
|     │   │ │   └─Selection_158                           | 0.33       | cop[tikv] |                                                    | gt(test.title.production_year, 2005)                                                                                                                                                                                         |
|     │   │ │     └─TableRangeScan_157                    | 1.00       | cop[tikv] | table:t                                            | range: decided by [test.cast_info.movie_id], keep order:false                                                                                                                                                                |
|     │   │ └─IndexLookUp_145(Probe)                      | 2.39       | root      |                                                    |                                                                                                                                                                                                                              |
|     │   │   ├─IndexRangeScan_143(Build)                 | 2.39       | cop[tikv] | table:mc, index:movie_id_movie_companies(movie_id) | range: decided by [eq(test.movie_companies.movie_id, test.title.id)], keep order:false                                                                                                                                       |
|     │   │   └─TableRowIDScan_144(Probe)                 | 2.39       | cop[tikv] | table:mc                                           | keep order:false                                                                                                                                                                                                             |
|     │   └─TableReader_132(Probe)                        | 0.00       | root      |                                                    | data:Selection_131                                                                                                                                                                                                           |
|     │     └─Selection_131                               | 0.00       | cop[tikv] |                                                    | eq(test.company_name.country_code, "[ru]")                                                                                                                                                                                   |
|     │       └─TableRangeScan_130                        | 1.00       | cop[tikv] | table:cn                                           | range: decided by [test.movie_companies.company_id], keep order:false                                                                                                                                                        |
|     └─TableReader_36(Probe)                             | 1.00       | root      |                                                    | data:TableRangeScan_35                                                                                                                                                                                                       |
|       └─TableRangeScan_35                               | 1.00       | cop[tikv] | table:chn                                          | range: decided by [test.cast_info.person_role_id], keep order:false                                                                                                                                                          |
+---------------------------------------------------------+------------+-----------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

explain /*+ nth_plan(7) */ SELECT MIN(chn.name) AS uncredited_voiced_character,        MIN(t.title) AS russian_movie FROM char_name AS chn,      cast_info AS ci,      company_name AS cn,      company_type AS ct,      movie_companies AS mc,      role_type AS rt,      title AS t WHERE ci.note LIKE '%(voice)%'   AND ci.note LIKE '%(uncredited)%'   AND cn.country_code = '[ru]'   AND rt.role = 'actor'   AND t.production_year > 2005   AND t.id = mc.movie_id   AND t.id = ci.movie_id   AND ci.movie_id = mc.movie_id   AND chn.id = ci.person_role_id   AND rt.id = ci.role_id   AND cn.id = mc.company_id   AND ct.id = mc.company_type_id;

+-----------------------------------------------------+------------+-----------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                                  | estRows    | task      | access object                              | operator info                                                                                                                                              |
+-----------------------------------------------------+------------+-----------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| HashAgg_29                                          | 1.00       | root      |                                            | funcs:min(test.char_name.name)->Column#43, funcs:min(test.title.title)->Column#44                                                                          |
| └─Projection_31                                     | 13268.84   | root      |                                            | test.char_name.name, test.title.title                                                                                                                      |
|   └─HashJoin_42                                     | 13268.84   | root      |                                            | inner join, equal:[eq(test.movie_companies.company_type_id, test.company_type.id)]                                                                         |
|     ├─TableReader_213(Build)                        | 4.00       | root      |                                            | data:TableFullScan_212                                                                                                                                     |
|     │ └─TableFullScan_212                           | 4.00       | cop[tikv] | table:ct                                   | keep order:false                                                                                                                                           |
|     └─HashJoin_67(Probe)                            | 13268.84   | root      |                                            | inner join, equal:[eq(test.movie_companies.company_id, test.company_name.id)]                                                                              |
|       ├─TableReader_211(Build)                      | 1174.00    | root      |                                            | data:Selection_210                                                                                                                                         |
|       │ └─Selection_210                             | 1174.00    | cop[tikv] |                                            | eq(test.company_name.country_code, "[ru]")                                                                                                                 |
|       │   └─TableFullScan_209                       | 234997.00  | cop[tikv] | table:cn                                   | keep order:false                                                                                                                                           |
|       └─HashJoin_81(Probe)                          | 2626460.93 | root      |                                            | inner join, equal:[eq(test.title.id, test.movie_companies.movie_id) eq(test.cast_info.movie_id, test.movie_companies.movie_id)]                            |
|         ├─HashJoin_93(Build)                        | 1777630.07 | root      |                                            | inner join, equal:[eq(test.cast_info.person_role_id, test.char_name.id)]                                                                                   |
|         │ ├─HashJoin_135(Build)                     | 1765899.55 | root      |                                            | inner join, equal:[eq(test.cast_info.movie_id, test.title.id)]                                                                                             |
|         │ │ ├─TableReader_204(Build)                | 1005082.25 | root      |                                            | data:Selection_203                                                                                                                                         |
|         │ │ │ └─Selection_203                       | 1005082.25 | cop[tikv] |                                            | gt(test.title.production_year, 2005)                                                                                                                       |
|         │ │ │   └─TableFullScan_202                 | 2528312.00 | cop[tikv] | table:t                                    | keep order:false                                                                                                                                           |
|         │ │ └─IndexHashJoin_163(Probe)              | 3294940.36 | root      |                                            | inner join, inner:IndexLookUp_160, outer key:test.role_type.id, inner key:test.cast_info.role_id, equal cond:eq(test.role_type.id, test.cast_info.role_id) |
|         │ │   ├─TableReader_194(Build)              | 1.00       | root      |                                            | data:Selection_193                                                                                                                                         |
|         │ │   │ └─Selection_193                     | 1.00       | cop[tikv] |                                            | eq(test.role_type.role, "actor")                                                                                                                           |
|         │ │   │   └─TableFullScan_192               | 12.00      | cop[tikv] | table:rt                                   | keep order:false                                                                                                                                           |
|         │ │   └─IndexLookUp_160(Probe)              | 3294940.36 | root      |                                            |                                                                                                                                                            |
|         │ │     ├─IndexRangeScan_157(Build)         | 4118675.45 | cop[tikv] | table:ci, index:role_id_cast_info(role_id) | range: decided by [eq(test.cast_info.role_id, test.role_type.id)], keep order:false                                                                        |
|         │ │     └─Selection_159(Probe)              | 3294940.36 | cop[tikv] |                                            | like(test.cast_info.note, "%(uncredited)%", 92), like(test.cast_info.note, "%(voice)%", 92), not(isnull(test.cast_info.person_role_id))                    |
|         │ │       └─TableRowIDScan_158              | 4118675.45 | cop[tikv] | table:ci                                   | keep order:false                                                                                                                                           |
|         │ └─TableReader_206(Probe)                  | 3140339.00 | root      |                                            | data:TableFullScan_205                                                                                                                                     |
|         │   └─TableFullScan_205                     | 3140339.00 | cop[tikv] | table:chn                                  | keep order:false                                                                                                                                           |
|         └─TableReader_208(Probe)                    | 2609129.00 | root      |                                            | data:TableFullScan_207                                                                                                                                     |
|           └─TableFullScan_207                       | 2609129.00 | cop[tikv] | table:mc                                   | keep order:false                                                                                                                                           |
+-----------------------------------------------------+------------+-----------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
